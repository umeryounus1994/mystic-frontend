<ngx-spinner bdColor="rgba(51,51,51,0.8)" size="medium" color="#fff" type="ball-scale-multiple" [fullScreen]="true">
  <p style="font-size: 30px; color: white">{{ 'COMMON.LOADING' | translate }}</p>
</ngx-spinner>

<div class="row mb-3">
  <div class="col-12 d-sm-flex justify-content-between align-items-center">
    <h1 class="h3 mb-2 mb-sm-0">{{ 'SIDEBAR.COMMISSION_RATE' | translate }}</h1>
    <button class="btn btn-outline-primary" (click)="loadCurrentRate()" [disabled]="loading">
      <i class="bi bi-arrow-repeat me-2"></i>{{ 'COMMON.RESET' | translate }}
    </button>
  </div>
</div>

<div class="row g-4">
  <div class="col-lg-8">
    <div class="card bg-transparent border">
      <div class="card-body">
        <p class="text-muted mb-3">
          Set the global commission rate (0â€“100). This is applied platform-wide unless overridden server-side.
        </p>

        <div class="alert alert-info" *ngIf="currentRate !== null">
          <strong>Current rate:</strong> {{ currentRate }}%
        </div>

        <form [formGroup]="form" (ngSubmit)="onSubmit()" class="row g-3">
          <div class="col-md-6">
            <label class="form-label">{{ 'FORMS.COMMISSION_RATE' | translate }} (%)</label>
            <input
              type="number"
              class="form-control"
              formControlName="rate"
              min="0"
              max="100"
              step="0.01"
              placeholder="15"
            />

            <div class="invalid-feedback d-block" *ngIf="rateCtrl?.touched && rateCtrl?.invalid">
              <div *ngIf="rateCtrl?.errors?.['required']">Rate is required.</div>
              <div *ngIf="rateCtrl?.errors?.['min'] || rateCtrl?.errors?.['max']">Rate must be between 0 and 100.</div>
              <div *ngIf="rateCtrl?.errors?.['pattern']">Rate must be a number.</div>
            </div>
          </div>

          <div class="col-12 d-flex gap-2">
            <button type="submit" class="btn btn-primary" [disabled]="loading">
              <i class="bi bi-save me-2"></i>{{ 'COMMON.UPDATE' | translate }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

